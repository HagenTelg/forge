[Unit]
Description=Forge acquisition event log
Before=forge-acquisition-initialize.target
Conflicts=forge-acquisition-stop.target
After=forge-acquisition-bus.socket
BindsTo=forge-acquisition-bus.socket

[Install]
WantedBy=forge-acquisition-initialize.target

[Service]
Type=notify
UMask=0007
User=forge-data
Group=forge
Restart=on-failure
TimeoutStopSec=30
WatchdogSec=30
RestartSec=5
ProtectSystem=strict
ProtectHome=true
WorkingDirectory=/
RuntimeDirectory=forge-eventlog
ReadWritePaths=/var/lib/forge/incoming
Environment=ROOT_PATH_FOR_DYNACONF=/etc/forge/acquisition
ExecStart=/opt/forge/venv/bin/forge-acquisition-event-log --systemd --data-working ${RUNTIME_DIRECTORY} --data-completed /var/lib/forge/incoming
ExecStopPost=find ${RUNTIME_DIRECTORY} -mindepth 1 -maxdepth 1 -type f -name *.nc -exec mv -- {} /var/lib/forge/incoming/ ;
